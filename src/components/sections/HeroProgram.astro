---
import Button from "../Button.astro";
import Form from "../Form.astro";
import { Image } from "astro:assets";

const GeneralData = Astro.props.GeneralData;
const { heading, text, buttonText, buttonLink, phoneQuestionText, treatmentsLabel, callButtonText, callButtonLink, navItems , hideButton = false } = Astro.props.Content;
---

<section class="lg:mx-auto mx-3 my-10 max-w-[1320px] max-md:my-10 max-md:rounded-3xl max-md:mx-6 max-sm:mx-2 relative">
  <div class="rounded-none">
    <section class="flex flex-col px-20 pt-6 pb-16 w-full bg-purple-900 rounded-3xl max-md:px-6 max-sm:px-4 max-md:max-w-full min-h-[500px] relative">
      <nav class="flex flex-wrap gap-10 justify-between items-center w-full text-base max-md:max-w-full mb-4">
        <a href="/">
          <img src="/imgs/hero_logo.png" alt="Company Logo" class="object-contain shrink-0 self-stretch my-auto aspect-[4.67] w-[159px]" />
        </a>
        <div class="lg:hidden">
          <button id="hamburgerButton" aria-label="Open menu" aria-expanded="false" class="text-white focus:outline-none">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>

        <ul class="hidden lg:flex flex-wrap gap-8 items-center self-stretch my-auto text-white">
          {navItems.map((item) => (
            <li class="group relative self-stretch my-auto whitespace-nowrap">
              <a href={item.url} class="text-white self-stretch my-auto flex items-center hover:text-gray-200 transition-colors">
                {item.text}
                {item.sublinks && item.sublinks.length > 0 && (
                  <Image
                    src="/imgs/dropdown_arrow.svg"
                    alt="Dropdown arrow"
                    class="object-contain shrink-0 self-stretch my-auto w-4 aspect-square ml-1"
                    width={16}
                    height={16}
                  />
                )}
              </a>
              {item.sublinks && item.sublinks.length > 0 && (
                <div class="absolute left-0 top-full hidden group-hover:block z-10 pt-2">
                  <section class="flex gap-2.5 p-6 mx-auto my-0 bg-white rounded-xl shadow-2xl max-w-[686px] max-md:p-5 max-sm:flex-col max-sm:p-4">
                    <article class="flex flex-col flex-1 gap-5">
                      <h2 class="text-lg font-medium text-neutral-800">
                        By Treatment Offering
                      </h2>
                      <ul class="flex flex-col gap-3">
                        {item.sublinks.map((sublink) => (
                          <li class="text-sm text-blue-900">
                            <a href={sublink.link}>{sublink.text}</a>
                          </li>
                        ))}
                      </ul>
                    </article>

                    <div class="mx-5 my-0 w-px bg-neutral-800 bg-opacity-10 max-sm:mx-0 max-sm:my-5 max-sm:w-full max-sm:h-px"></div>

                    <article class="flex flex-col flex-1 gap-5">
                      <h2 class="text-lg font-medium text-neutral-800">
                        By what your experiencing
                      </h2>
                      <ul class="flex flex-col gap-3">
                        {item.sublinks2 && item.sublinks2.map((sublink) => (
                          <li class="text-sm text-blue-900">
                            <a href={sublink.link}>{sublink.text}</a>
                          </li>
                        ))}
                      </ul>
                    </article>
                  </section>
                </div>
              )}
            </li>
          ))}
        </ul>

        <a href={`tel:${callButtonLink}`} class="hidden xl:flex flex-col justify-center self-stretch px-6 py-2.5 my-auto text-purple-900 bg-white min-h-[44px] rounded-[50px] font-medium hover:bg-gray-100 transition-colors">
          <span class="gap-1 self-stretch text-center">{callButtonText}</span>
        </a>
      </nav>

      <!-- Mobile Navigation -->
      <div id="mobileNav" class="fixed inset-0 z-50 bg-white text-purple-900 p-6 hidden flex-col lg:hidden">
        <div class="flex justify-between items-center mb-8">
          <Image src="/imgs/hero_logo.png" alt="Company Logo Mobile" class="object-contain shrink-0 h-10" width={159} height={40} />
          <button id="closeMobileNavButton" aria-label="Close menu" class="focus:outline-none">
            <svg class="w-8 h-8 text-purple-900" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>

        <ul class="flex flex-col items-start gap-4 text-xl overflow-y-auto flex-grow">
          {navItems.map((item) => (
            <li class="w-full">
              <a href={item.url} class="hover:text-amber-500 py-2 block font-medium">{item.text}</a>
              {(item.sublinks && item.sublinks.length > 0 || item.sublinks2 && item.sublinks2.length > 0) && (
                <div class="pl-4 mt-1 space-y-1 text-lg">
                  {item.sublinks && item.sublinks.length > 0 && (
                    <>
                      <h3 class="text-md font-semibold text-neutral-700 mb-2">By Treatment Offering</h3>
                      <ul class="flex flex-col gap-2">
                        {item.sublinks.map((sublink) => (
                          <li>
                            <a href={sublink.link} class="text-sm text-blue-700 hover:underline block py-1">
                              {sublink.text}
                            </a>
                          </li>
                        ))}
                      </ul>
                    </>
                  )}
                  {item.sublinks2 && item.sublinks2.length > 0 && (
                    <>
                      <div class="my-3 h-px bg-gray-200"></div>
                      <h3 class="text-md font-semibold text-neutral-700 mb-2">By what you're experiencing</h3>
                      <ul class="flex flex-col gap-2">
                        {item.sublinks2.map((sublink) => (
                          <li>
                            <a href={sublink.link} class="text-sm text-blue-700 hover:underline block py-1">
                              {sublink.text}
                            </a>
                          </li>
                        ))}
                      </ul>
                    </>
                  )}
                </div>
              )}
            </li>
          ))}
          <li class="mt-auto pt-6 w-full">
            <a href={`tel:${callButtonLink}`} class="block w-full text-center px-6 py-3.5 text-lg font-semibold text-white bg-purple-800 rounded-[50px] hover:bg-purple-700">
              {callButtonText} 
            </a>
          </li>
        </ul>
      </div>

      <!-- Main Content Section - Centered -->
      <div class="flex-1 flex items-center justify-center">
        <section class="flex flex-col items-center text-center max-w-2xl mx-auto px-4">
          <!-- Treatment Label Badge -->
          <div class="mb-6">
            <span class="inline-block px-8 py-2 text-sm font-medium text-purple-900 bg-white rounded-full">
              {treatmentsLabel}
            </span>
          </div>

          <!-- Main Heading -->
          <h1 class="text-5xl font-bold text-white leading-tight mb-4 max-md:text-4xl max-sm:text-3xl">
            {heading}
          </h1>

          <!-- Description Text -->
          <p class="text-lg text-white text-center mb-8 leading-relaxed max-w-lg opacity-90">
            {text}
          </p>

          <!-- Action Buttons -->
          {hideButton == false && (
            <div class="flex flex-col sm:flex-row gap-4 w-full max-w-md">
              <a href={buttonLink} class="flex-1 inline-flex items-center justify-center px-8 py-4 text-lg font-semibold text-black bg-yellow-400 rounded-full hover:bg-yellow-300 transition-colors min-h-[56px]">
                {buttonText}
              </a>

              <a href={`tel:${callButtonLink}`} class="flex-1 inline-flex flex-col items-center justify-center px-6 py-3 text-purple-900 bg-white rounded-full hover:bg-gray-100 transition-colors min-h-[56px]">
                <span class="text-xs text-gray-600 leading-tight">{phoneQuestionText}</span>
                <span class="text-sm font-semibold leading-tight">{callButtonText}</span>
              </a>
            </div>
          )}
        </section>
      </div>
    </section>
  </div>
</section>

<script is:inline>
  document.addEventListener('DOMContentLoaded', () => {
    const hamburgerButton = document.getElementById('hamburgerButton');
    const mobileNav = document.getElementById('mobileNav');
    const closeMobileNavButton = document.getElementById('closeMobileNavButton');

    function toggleMobileNav(show) {
      if (mobileNav && hamburgerButton) {
        if (show) {
          mobileNav.classList.remove('hidden');
          mobileNav.classList.add('flex');
          document.body.style.overflow = 'hidden';
          hamburgerButton.setAttribute('aria-expanded', 'true');
        } else {
          mobileNav.classList.add('hidden');
          mobileNav.classList.remove('flex');
          document.body.style.overflow = '';
          hamburgerButton.setAttribute('aria-expanded', 'false');
        }
      }
    }

    if (hamburgerButton) {
      hamburgerButton.addEventListener('click', () => {
        const isExpanded = hamburgerButton.getAttribute('aria-expanded') === 'true';
        toggleMobileNav(!isExpanded);
      });
    }

    if (closeMobileNavButton) {
      closeMobileNavButton.addEventListener('click', () => {
        toggleMobileNav(false);
      });
    }

    if (mobileNav) {
      const mobileNavLinks = mobileNav.querySelectorAll('a');
      mobileNavLinks.forEach(link => {
        link.addEventListener('click', () => {
          if (!mobileNav.classList.contains('hidden')) {
            toggleMobileNav(false);
          }
        });
      });
    }
  });
</script>